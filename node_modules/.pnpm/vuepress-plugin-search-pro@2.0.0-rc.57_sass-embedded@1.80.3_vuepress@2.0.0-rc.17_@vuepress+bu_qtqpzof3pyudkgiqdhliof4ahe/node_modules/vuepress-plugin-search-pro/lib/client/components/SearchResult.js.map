{"version":3,"file":"SearchResult.js","sources":["../../../src/client/composables/queryHistory.ts","../../../src/client/utils/getPath.ts","../../../src/client/composables/resultHistory.ts","../../../src/client/composables/search.ts","../../../src/client/components/SearchResult.ts"],"sourcesContent":["import { useLocalStorage } from \"@vueuse/core\";\nimport type { Ref } from \"vue\";\n\nimport { searchProOptions } from \"../define.js\";\n\nconst SEARCH_PRO_HISTORY_QUERY_STORAGE = \"SEARCH_PRO_QUERY_HISTORY\";\n\nexport interface SearchQueryHistory {\n  enabled: boolean;\n  queryHistory: Ref<string[]>;\n  addQueryHistory: (item: string) => void;\n  removeQueryHistory: (index: number) => void;\n}\n\nconst searchProQueryStorage = useLocalStorage<string[]>(\n  SEARCH_PRO_HISTORY_QUERY_STORAGE,\n  [],\n);\n\nexport const useSearchQueryHistory = (): SearchQueryHistory => {\n  const { queryHistoryCount } = searchProOptions;\n  const enabled = queryHistoryCount > 0;\n\n  const addQueryHistory = (item: string): void => {\n    if (enabled)\n      searchProQueryStorage.value = Array.from(\n        new Set([\n          item,\n          ...searchProQueryStorage.value.slice(0, queryHistoryCount - 1),\n        ]),\n      );\n  };\n\n  const removeQueryHistory = (index: number): void => {\n    searchProQueryStorage.value = [\n      ...searchProQueryStorage.value.slice(0, index),\n      ...searchProQueryStorage.value.slice(index + 1),\n    ];\n  };\n\n  return {\n    enabled,\n    queryHistory: searchProQueryStorage,\n    addQueryHistory,\n    removeQueryHistory,\n  };\n};\n","import { store } from \"@temp/search-pro/store.js\";\n\nimport type { MatchedItem } from \"../typings/index.js\";\n\nexport const getPath = (item: MatchedItem): string =>\n  store[item.id] + (\"anchor\" in item ? `#${item.anchor}` : \"\");\n","import { useLocalStorage } from \"@vueuse/core\";\nimport type { Ref } from \"vue\";\n\nimport { searchProOptions } from \"../define.js\";\nimport type { MatchedItem, Word } from \"../typings/index.js\";\nimport { getPath } from \"../utils/index.js\";\n\nconst SEARCH_PRO_HISTORY_RESULT_STORAGE = \"SEARCH_PRO_RESULT_HISTORY\";\n\nexport interface SearchResult {\n  header?: string;\n  link: string;\n  display: Word[][];\n}\n\nexport interface SearchResultHistory {\n  enabled: boolean;\n  resultHistory: Ref<SearchResult[]>;\n  addResultHistory: (item: MatchedItem) => void;\n  removeResultHistory: (index: number) => void;\n}\n\nconst { resultHistoryCount } = searchProOptions;\n\nconst searchProResultStorage = useLocalStorage<SearchResult[]>(\n  SEARCH_PRO_HISTORY_RESULT_STORAGE,\n  [],\n);\n\nexport const useSearchResultHistory = (): SearchResultHistory => {\n  const enabled = resultHistoryCount > 0;\n\n  const addResultHistory = (item: MatchedItem): void => {\n    if (enabled) {\n      const result: SearchResult = {\n        link: getPath(item),\n        display: item.display,\n      };\n\n      if (\"header\" in item) result.header = item.header;\n\n      searchProResultStorage.value = [\n        result,\n        ...searchProResultStorage.value.slice(0, resultHistoryCount - 1),\n      ];\n    }\n  };\n\n  const removeResultHistory = (index: number): void => {\n    searchProResultStorage.value = [\n      ...searchProResultStorage.value.slice(0, index),\n      ...searchProResultStorage.value.slice(index + 1),\n    ];\n  };\n\n  return {\n    enabled,\n    resultHistory: searchProResultStorage,\n    addResultHistory,\n    removeResultHistory,\n  };\n};\n","import { useDebounceFn } from \"@vueuse/core\";\nimport type { Ref } from \"vue\";\nimport { computed, onMounted, onUnmounted, ref, shallowRef, watch } from \"vue\";\nimport { usePageData, useRouteLocale } from \"vuepress/client\";\n\nimport { createSearchWorker } from \"../createSearchWorker.js\";\nimport { searchProOptions } from \"../define.js\";\nimport { useSearchOptions } from \"../helpers/index.js\";\nimport type { SearchResult } from \"../typings/index.js\";\n\nexport interface SearchRef {\n  isSearching: Ref<boolean>;\n  results: Ref<SearchResult[]>;\n}\n\nexport const useSearchResult = (queries: Ref<string[]>): SearchRef => {\n  const searchOptions = useSearchOptions();\n  const routeLocale = useRouteLocale();\n  const pageData = usePageData();\n\n  const searchingProcessNumber = ref(0);\n  const isSearching = computed(() => searchingProcessNumber.value > 0);\n  const results = shallowRef<SearchResult[]>([]);\n\n  onMounted(() => {\n    const { search, terminate } = createSearchWorker();\n\n    const performSearch = useDebounceFn((queries: string[]): void => {\n      const query = queries.join(\" \");\n      const {\n        searchFilter = (results): SearchResult[] => results,\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        splitWord,\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        suggestionsFilter,\n        ...options\n      } = searchOptions.value;\n\n      if (query) {\n        searchingProcessNumber.value += 1;\n\n        search(queries.join(\" \"), routeLocale.value, options)\n          .then((results) =>\n            searchFilter(results, query, routeLocale.value, pageData.value),\n          )\n          .then((_results) => {\n            searchingProcessNumber.value -= 1;\n            results.value = _results;\n          })\n          .catch((err) => {\n            console.warn(err);\n            searchingProcessNumber.value -= 1;\n            if (!searchingProcessNumber.value) results.value = [];\n          });\n      } else {\n        results.value = [];\n      }\n    }, searchProOptions.searchDelay - searchProOptions.suggestDelay);\n\n    watch([queries, routeLocale], ([queries]) => performSearch(queries), {\n      immediate: true,\n    });\n\n    onUnmounted(() => {\n      terminate();\n    });\n  });\n\n  return {\n    isSearching,\n    results,\n  };\n};\n","import {\n  isPlainObject,\n  isString,\n  useLocaleConfig,\n} from \"@vuepress/helper/client\";\nimport { useEventListener } from \"@vueuse/core\";\nimport type { PropType, VNode } from \"vue\";\nimport { computed, defineComponent, h, reactive, ref, toRef, watch } from \"vue\";\nimport { RouteLink, useRouteLocale, useRouter } from \"vuepress/client\";\n\nimport { SearchLoading } from \"./SearchLoading.js\";\nimport { HeadingIcon, HeartIcon, HistoryIcon, TitleIcon } from \"./icons.js\";\nimport {\n  useSearchQueryHistory,\n  useSearchResult,\n  useSearchResultHistory,\n} from \"../composables/index.js\";\nimport {\n  searchProClientCustomFiledConfig,\n  searchProLocales,\n} from \"../define.js\";\nimport type { MatchedItem, Word } from \"../typings/index.js\";\nimport { CLOSE_ICON, getPath } from \"../utils/index.js\";\n\nimport \"../styles/search-result.scss\";\n\nexport default defineComponent({\n  name: \"SearchResult\",\n\n  props: {\n    /**\n     * Query string\n     *\n     * 查询字符串\n     */\n    queries: {\n      type: Array as PropType<string[]>,\n      required: true,\n    },\n\n    /**\n     * Whether is focusing\n     *\n     * 是否被聚焦\n     */\n    isFocusing: Boolean,\n  },\n\n  emits: [\"close\", \"updateQuery\"],\n\n  setup(props, { emit }) {\n    const router = useRouter();\n    const routeLocale = useRouteLocale();\n    const locale = useLocaleConfig(searchProLocales);\n    const {\n      enabled: enableQueryHistory,\n      addQueryHistory,\n      queryHistory,\n      removeQueryHistory,\n    } = useSearchQueryHistory();\n    const {\n      enabled: enableResultHistory,\n      resultHistory,\n      addResultHistory,\n      removeResultHistory,\n    } = useSearchResultHistory();\n    const enableHistory = enableQueryHistory || enableResultHistory;\n\n    const queries = toRef(props, \"queries\");\n    const { results, isSearching } = useSearchResult(queries);\n\n    const activatedHistoryStatus = reactive({ isQuery: true, index: 0 });\n    const activatedResultIndex = ref(0);\n    const activatedResultContentIndex = ref(0);\n\n    const hasHistory = computed(\n      () =>\n        enableHistory &&\n        (queryHistory.value.length > 0 || resultHistory.value.length > 0),\n    );\n    const hasResults = computed(() => results.value.length > 0);\n    const activatedResult = computed(\n      () => results.value[activatedResultIndex.value] || null,\n    );\n\n    const activePreviousHistory = (): void => {\n      const { isQuery, index } = activatedHistoryStatus;\n\n      if (index === 0) {\n        activatedHistoryStatus.isQuery = !isQuery;\n        activatedHistoryStatus.index = isQuery\n          ? resultHistory.value.length - 1\n          : queryHistory.value.length - 1;\n      } else {\n        activatedHistoryStatus.index = index - 1;\n      }\n    };\n\n    const activeNextHistory = (): void => {\n      const { isQuery, index } = activatedHistoryStatus;\n\n      if (\n        index ===\n        (isQuery\n          ? queryHistory.value.length - 1\n          : resultHistory.value.length - 1)\n      ) {\n        activatedHistoryStatus.isQuery = !isQuery;\n        activatedHistoryStatus.index = 0;\n      } else {\n        activatedHistoryStatus.index = index + 1;\n      }\n    };\n\n    const activePreviousResult = (): void => {\n      activatedResultIndex.value =\n        activatedResultIndex.value > 0\n          ? activatedResultIndex.value - 1\n          : results.value.length - 1;\n      activatedResultContentIndex.value =\n        activatedResult.value.contents.length - 1;\n    };\n\n    const activeNextResult = (): void => {\n      activatedResultIndex.value =\n        activatedResultIndex.value < results.value.length - 1\n          ? activatedResultIndex.value + 1\n          : 0;\n      activatedResultContentIndex.value = 0;\n    };\n\n    const activeNextResultContent = (): void => {\n      if (\n        activatedResultContentIndex.value <\n        activatedResult.value.contents.length - 1\n      )\n        activatedResultContentIndex.value += 1;\n      else activeNextResult();\n    };\n\n    const activePreviousResultContent = (): void => {\n      if (activatedResultContentIndex.value > 0)\n        activatedResultContentIndex.value -= 1;\n      else activePreviousResult();\n    };\n\n    const getVNodes = (display: Word[]): (VNode | string)[] =>\n      display.map((word) => (isString(word) ? word : h(word[0], word[1])));\n\n    const getDisplay = (matchedItem: MatchedItem): (VNode | string)[] => {\n      if (matchedItem.type === \"customField\") {\n        const formatterConfig =\n          searchProClientCustomFiledConfig[matchedItem.index] || \"$content\";\n\n        const [prefix, suffix = \"\"] = isPlainObject(formatterConfig)\n          ? formatterConfig[routeLocale.value].split(\"$content\")\n          : formatterConfig.split(\"$content\");\n\n        return matchedItem.display.map((display) =>\n          h(\"div\", getVNodes([prefix, ...display, suffix])),\n        );\n      }\n\n      return matchedItem.display.map((display) => h(\"div\", getVNodes(display)));\n    };\n\n    const resetSearchResult = (): void => {\n      activatedResultIndex.value = 0;\n      activatedResultContentIndex.value = 0;\n      emit(\"updateQuery\", \"\");\n      emit(\"close\");\n    };\n\n    const renderSearchQueryHistory = (): VNode | null =>\n      enableQueryHistory\n        ? h(\n            \"ul\",\n            { class: \"search-pro-result-list\" },\n            h(\"li\", { class: \"search-pro-result-list-item\" }, [\n              h(\n                \"div\",\n                { class: \"search-pro-result-title\" },\n                locale.value.queryHistory,\n              ),\n              queryHistory.value.map((item, historyIndex) =>\n                h(\n                  \"div\",\n                  {\n                    class: [\n                      \"search-pro-result-item\",\n                      {\n                        active:\n                          activatedHistoryStatus.isQuery &&\n                          activatedHistoryStatus.index === historyIndex,\n                      },\n                    ],\n                    onClick: () => {\n                      emit(\"updateQuery\", item);\n                    },\n                  },\n                  [\n                    h(HistoryIcon, {\n                      class: \"search-pro-result-type\",\n                    }),\n                    h(\"div\", { class: \"search-pro-result-content\" }, item),\n                    h(\"button\", {\n                      class: \"search-pro-remove-icon\",\n                      innerHTML: CLOSE_ICON,\n                      onClick: (event: Event) => {\n                        event.preventDefault();\n                        event.stopPropagation();\n                        removeQueryHistory(historyIndex);\n                      },\n                    }),\n                  ],\n                ),\n              ),\n            ]),\n          )\n        : null;\n\n    const renderSearchResultHistory = (): VNode | null =>\n      enableResultHistory\n        ? h(\n            \"ul\",\n            { class: \"search-pro-result-list\" },\n            h(\"li\", { class: \"search-pro-result-list-item\" }, [\n              h(\n                \"div\",\n                { class: \"search-pro-result-title\" },\n                locale.value.resultHistory,\n              ),\n\n              resultHistory.value.map((item, historyIndex) =>\n                h(\n                  RouteLink,\n                  {\n                    to: item.link,\n                    class: [\n                      \"search-pro-result-item\",\n                      {\n                        active:\n                          !activatedHistoryStatus.isQuery &&\n                          activatedHistoryStatus.index === historyIndex,\n                      },\n                    ],\n                    onClick: () => {\n                      resetSearchResult();\n                    },\n                  },\n                  () => [\n                    h(HistoryIcon, {\n                      class: \"search-pro-result-type\",\n                    }),\n                    h(\"div\", { class: \"search-pro-result-content\" }, [\n                      item.header\n                        ? h(\"div\", { class: \"content-header\" }, item.header)\n                        : null,\n                      h(\n                        \"div\",\n                        item.display\n                          .map((display) => getVNodes(display))\n                          .flat(),\n                      ),\n                    ]),\n                    h(\"button\", {\n                      class: \"search-pro-remove-icon\",\n                      innerHTML: CLOSE_ICON,\n                      onClick: (event: Event) => {\n                        event.preventDefault();\n                        event.stopPropagation();\n                        removeResultHistory(historyIndex);\n                      },\n                    }),\n                  ],\n                ),\n              ),\n            ]),\n          )\n        : null;\n\n    useEventListener(\"keydown\", (event: KeyboardEvent) => {\n      if (!props.isFocusing) return;\n\n      if (hasResults.value) {\n        if (event.key === \"ArrowUp\") {\n          activePreviousResultContent();\n        } else if (event.key === \"ArrowDown\") {\n          activeNextResultContent();\n        } else if (event.key === \"Enter\") {\n          const item =\n            activatedResult.value.contents[activatedResultContentIndex.value];\n\n          addQueryHistory(props.queries.join(\" \"));\n          addResultHistory(item);\n          void router.push(getPath(item));\n          resetSearchResult();\n        }\n      } else if (enableResultHistory) {\n        if (event.key === \"ArrowUp\") {\n          activePreviousHistory();\n        } else if (event.key === \"ArrowDown\") {\n          activeNextHistory();\n        } else if (event.key === \"Enter\") {\n          const { index } = activatedHistoryStatus;\n\n          if (activatedHistoryStatus.isQuery) {\n            emit(\"updateQuery\", queryHistory.value[index]);\n            event.preventDefault();\n          } else {\n            void router.push(resultHistory.value[index].link);\n            resetSearchResult();\n          }\n        }\n      }\n    });\n\n    watch(\n      [activatedResultIndex, activatedResultContentIndex],\n      () => {\n        document\n          .querySelector(\n            \".search-pro-result-list-item.active .search-pro-result-item.active\",\n          )\n          ?.scrollIntoView(false);\n      },\n      { flush: \"post\" },\n    );\n\n    return (): VNode =>\n      h(\n        \"div\",\n        {\n          class: [\n            \"search-pro-result-wrapper\",\n            {\n              empty: props.queries.length\n                ? !hasResults.value\n                : !hasHistory.value,\n            },\n          ],\n          id: \"search-pro-results\",\n        },\n        props.queries.length\n          ? isSearching.value\n            ? h(SearchLoading, { hint: locale.value.searching })\n            : hasResults.value\n              ? h(\n                  \"ul\",\n                  { class: \"search-pro-result-list\" },\n                  results.value.map(({ title, contents }, index) => {\n                    const isCurrentResultActive =\n                      activatedResultIndex.value === index;\n\n                    return h(\n                      \"li\",\n                      {\n                        class: [\n                          \"search-pro-result-list-item\",\n                          { active: isCurrentResultActive },\n                        ],\n                      },\n                      [\n                        h(\n                          \"div\",\n                          { class: \"search-pro-result-title\" },\n                          title || locale.value.defaultTitle,\n                        ),\n                        contents.map((item, contentIndex) => {\n                          const isCurrentContentActive =\n                            isCurrentResultActive &&\n                            activatedResultContentIndex.value === contentIndex;\n\n                          return h(\n                            RouteLink,\n                            {\n                              to: getPath(item),\n                              class: [\n                                \"search-pro-result-item\",\n                                {\n                                  active: isCurrentContentActive,\n                                  \"aria-selected\": isCurrentContentActive,\n                                },\n                              ],\n                              onClick: () => {\n                                addQueryHistory(props.queries.join(\" \"));\n                                addResultHistory(item);\n                                resetSearchResult();\n                              },\n                            },\n                            () => [\n                              item.type === \"text\"\n                                ? null\n                                : h(\n                                    item.type === \"title\"\n                                      ? TitleIcon\n                                      : item.type === \"heading\"\n                                        ? HeadingIcon\n                                        : HeartIcon,\n                                    { class: \"search-pro-result-type\" },\n                                  ),\n                              h(\"div\", { class: \"search-pro-result-content\" }, [\n                                item.type === \"text\" && item.header\n                                  ? h(\n                                      \"div\",\n                                      { class: \"content-header\" },\n                                      item.header,\n                                    )\n                                  : null,\n                                h(\"div\", getDisplay(item)),\n                              ]),\n                            ],\n                          );\n                        }),\n                      ],\n                    );\n                  }),\n                )\n              : locale.value.emptyResult\n          : enableHistory\n            ? hasHistory.value\n              ? [renderSearchQueryHistory(), renderSearchResultHistory()]\n              : locale.value.emptyHistory\n            : locale.value.emptyResult,\n      );\n  },\n});\n"],"names":["SEARCH_PRO_HISTORY_QUERY_STORAGE","searchProQueryStorage","useLocalStorage","useSearchQueryHistory","queryHistoryCount","searchProOptions","enabled","item","index","getPath","store","SEARCH_PRO_HISTORY_RESULT_STORAGE","resultHistoryCount","searchProResultStorage","useSearchResultHistory","result","useSearchResult","queries","searchOptions","useSearchOptions","routeLocale","useRouteLocale","pageData","usePageData","searchingProcessNumber","ref","isSearching","computed","results","shallowRef","onMounted","search","terminate","createSearchWorker","performSearch","useDebounceFn","query","searchFilter","splitWord","suggestionsFilter","options","_results","err","watch","onUnmounted","defineComponent","props","emit","router","useRouter","locale","useLocaleConfig","searchProLocales","enableQueryHistory","addQueryHistory","queryHistory","removeQueryHistory","enableResultHistory","resultHistory","addResultHistory","removeResultHistory","enableHistory","toRef","activatedHistoryStatus","reactive","activatedResultIndex","activatedResultContentIndex","hasHistory","hasResults","activatedResult","activePreviousHistory","isQuery","activeNextHistory","activePreviousResult","activeNextResult","activeNextResultContent","activePreviousResultContent","getVNodes","display","word","isString","h","getDisplay","matchedItem","formatterConfig","searchProClientCustomFiledConfig","prefix","suffix","isPlainObject","resetSearchResult","renderSearchQueryHistory","historyIndex","HistoryIcon","CLOSE_ICON","event","renderSearchResultHistory","RouteLink","useEventListener","SearchLoading","title","contents","isCurrentResultActive","contentIndex","isCurrentContentActive","TitleIcon","HeadingIcon","HeartIcon"],"mappings":"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"}